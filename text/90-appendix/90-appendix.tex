\renewcommand{\imagepath}{../90-appendix/img}
\appendix

\chapter{Details of the Trap Laser Setup}
This appendix chapter gives some more detailed information about the optical elements used in the trap laser setup, as described in chapter~\ref{ch:light_preparation}, as well as important power ratios measured in the implemented setup for the light for two-dimensional magneto-optical trap.

\section{Important Optical Elements}\label{ch:optical_components}
In the optics setup for the magneto-optical traps, the following optical components are used for generating the trap laser light:

\paragraph{Polarizing beam splitter cubes} Polarizing beam splitter (PBS) cubes spatially split a laser beam into its $\KetText{H}$- and $\KetText{V}$-polarized components. The $\KetText{H}$ component passes through the cube while the $\KetText{V}$ component is deflected. In the trap laser setup, polarizing beam splitter cubes are used for splitting a laser beam into portions of arbitrary power using a preceding half-wave plate for setting the incident polarization accordingly, and for overlapping two beams of different polarization into a common spatial mode.

The polarizing beam splitter cubes used for building the laser setup were manufactured by CeNing Optics with a specified transmission extinction ratio error of $\frac{1}{1000}$ and a surface reflectivity of $<\SI{0.25}{\percent}$.
    
\paragraph*{Wave plates} Wave plates allow changing the polarization of a beam. They are made of birefringent crystals cut to the right length such that the there is a defined phase retardation between the fast and the slow axis of the crystal. Half-wave plates (HWP) generate a \SI{180}{\degree} phase difference, quarter-wave plates (QWP) generate a \SI{90}{\degree} phase difference between their axes. Depending on the angle between the axes of the crystal and the polarization components of the beam, half-wave plates can turn linear polarization into any other arbitrary linear polarization, whereas quarter-wave plates change the ellipticity of the polarization state and can hence generate circularly polarized light.

Using a quarter- and a half-wave plate, linear polarization can be turned into any arbitrary polarization state. For turning an arbitrary polarization state into any other polarization state, an arrangement of quarter-, half-, and another quarter-wave plate is necessary as a single quarter-wave plate cannot arbitrarily change the ellipticity of incident elliptical light. An intuitive example of why only a quarter- and a half-wave plate are not sufficient for turning an arbitrary polarization state into any other polarization state is the transformation of circular light into elliptical light of any arbitrary ellipticity: A quarter-wave plate always transforms circularly polarized light into linearly polarized light, so at least one additional quarter-wave plate is necessary for creating arbitrary ellipticity.

The wave plates used for building the laser setup were zero-order wave plates sold by Laser Components (part numbers:  WPZ-671-04-2-R05, WPZ-671-09-2-R10, WPZ-671-04-4-R05,  WPZ-671-09-4-R10) with a specified retardance threshold of $\frac{\lambda}{300}$ and reflectance of $<\SI{0.2}{\percent}$.
    
\paragraph{Acousto-optic modulators} Acousto-optic modulators (AOM) allow changing the optical frequency of a laser beam by multiples of the operating frequency $f_\text{AOM}$, typically in the order of \SI[]{e2}{\mega\hertz}. The beam is sent through a crystal in which the index of refraction $n$ is spatially modulated perpendicular to the beam direction by an acoustic wave of frequency $f_\text{AOM}$. The incident laser light is diffracted on this spatial modulation of the index of refraction, leading to multiple light beams after of the modulator at angles $\eta_m$ with $\sin \eta_m = m\frac{\lambda_\text{light}}{\lambda_\text{acoustic}}$ where $m \in \{..., -2, -1, 0, 1, 2, ...\}$ is the order of each refracted beam and $\lambda_\text{light}, \lambda_\text{acoustic}$ are the optical and acoustic wave lengths. The beam of order $m$ is frequency-shifted by $\Delta f = mf_\text{AOM}$~\cite{hunsperger_acousto-optic_2002}.

In the trap laser setup, acousto-optic modulators are used for increasing or decreasing the frequency of a laser beam and as fast optical shutters by switching the diffraction on and off. Sending light forwards and backwards through an acousto-optic modulator using a mirror, a so-called double-pass, doubles the frequency shift of the light and avoids the angular diffraction, which cancels out for both passes through the modulator. While propagating through the double-pass, the light is polarization-turned from $\KetText{H}$ to $\KetText{V}$ using a quarter-wave plate that the laser beam traverses in forward and backward direction, such that incoming and outgoing light can be separated on a polarizing beam splitter. Typical coupling efficiencies for the first order are \SIrange[]{80}{90}{\percent}.

The acousto-optic modulators used in the laser setup were produced by Gooch \& Housego (part numbers: 3080-120, frequency range: \SI{80(10)}{\mega\hertz}, active aperture of \SI{1}{\milli\meter} and 3110-120, frequency range: \SI{110(12)}{\mega\hertz}, active aperture of \SI{0.6}{\milli\meter}).

\paragraph{Telescope} A telescope reduces the diameter of a collimated laser beam. It consists of two lenses, the first being convex ($f > 0$) focusing down the laser beam, the second being concave ($f < 0$) re-collimating the beam.
    
\paragraph{Fiber Incouplers} An incoupler arrangement feeds a free-space laser beam into an optical fiber. The beam is focused down onto the tip of the fiber using an aspheric lens with an appropriate focal length such that the waist of the focused beam matches with the fiber size. Typical coupling efficiens range between \SIrange[]{80}{90}{\percent}.
    
\paragraph{Mirrors}
In the trap laser setup, mirrors with a broadband anti-reflection coating for incidence angles from \SIrange[]{0}{45}{\degree} from the vendors Thorlabs (part numbers: BB1-E02-10 and BB1-E02-05 with a specified reflectivity of \SIrange[]{99}{100}{\percent} (depending on polarization) at \SI[]{45}{\degree} and \SI[]{99}{\percent} at \SI[]{8}{\degree} at \SI[]{671}{\nano\meter}) and Laser Components (part numbers: 3051012 and 3051014 with a specficied transmittivity of \SI[]{0.04}{\percent} at \SI[]{45}{\degree} and \SI[]{0.03}{\percent} at \SI[]{0}{\degree} at \SI[]{671}{\nano\meter}, back-polished) were used. For the Laser Components mirrors, it was experimentally verified that arbitrary incident polarization states were transformed in the same way by different mirrors from the same batch at \SI[]{45}{\degree} incidence angle.

\paragraph{Optical Isolator}
In order to prevent any inadvertent reflections travelling back into the Raman fiber amplifier supplying the board the D$_2$ light, an optical isolator (Newport ISO-04-650-MP-WP) was placed immediately after the doubling stage. In a power measurement, \SI{30}{\deci\bel} damping (with the isolator inverted) and over \SI{95}{\percent} transmission could be attested in agreement with the specifications.

\section{Power Dissipations, Recombination, and Splitting Ratios}\label{ch:power_losses}
For the laser setup for the two-dimensional magneto-optical trap, table~\ref{tab:power_loss_table} lists the measured remaining power levels after each dissipating element. Table~\ref{tab:power_recombination} compares the cooler and repumper power on the recombination cube, and table~\ref{tab:power_splitting} gives the measured splitting ratios into the two optical fibers.

\begin{table}[h]
    \centering
    \begin{tabular}{lllc}
        \toprule
        \multicolumn{2}{l}{\textbf{element}} & \textbf{markers} (fig.~\ref{fig:2d_mot_setup_photo}) & \textbf{power after element} \\
        \toprule
        isolator & & b & \SI{97}{\percent} \\
        \midrule
        telescope & & g & \SI{99}{\percent} \\
        \midrule
        \multirow{3}{*}{switching AOM} & all orders & h & \SI{100}{\percent} \\ 
        & first order & h - o & \SI{83}{\percent} \\
        \midrule
        \multirow{2}{*}{cooler AOM} & all orders & q & \SI{97}{\percent} \\
        & first order  & q - r & \SI{76}{\percent} \\
        \midrule
        \multirow{2}{*}{repumper AOM} & all orders & p & \SI{99}{\percent} \\
        & first order  & p - r & \SI{81}{\percent} \\
        \midrule
        \multirow{3}{*}{fiber A} & cooler \& repumper & s - t & \SI{84}{\percent} \\
        & cooler & q - t & \SI{78}{\percent} \\
        & repumper & p - t & \SI{81}{\percent} \\
        \midrule
        \multirow{3}{*}{fiber B} & cooler \& repumper & s - u & \SI{74}{\percent} \\
        & cooler & q - u & \SI{71}{\percent} \\
        & repumper & p - u & \SI{77}{\percent} \\
        \bottomrule
    \end{tabular}
    \caption{Measured remaining powers after dissipating elements on the optics board for the two-dimensional magneto-optical trap}
    \label{tab:power_loss_table}
\end{table}

\begin{table}[h]
    \centering
    \begin{tabular}{llc}
        \toprule
        \textbf{beam} & \textbf{markers} (fig.~\ref{fig:2d_mot_setup_photo}) & \textbf{percentage} \\
        \toprule
        cooler & q - r & \SI{51}{\percent} \\
        repumper & p - r & \SI{47}{\percent} \\
        \bottomrule
    \end{tabular}
    \caption{Measured power ratios of the recombined cooler and repumper beams on the polarizing beam splitter cube r on the optics board for the two-dimensional magneto-optical trap}
    \label{tab:power_recombination}
\end{table}

\begin{table}[h]
    \centering
    \begin{tabular}{lllc}
        \toprule
        \textbf{beam} & \textbf{branch} & \textbf{markers} (fig.~\ref{fig:2d_mot_setup_photo}) & \textbf{ratio} \\
        \toprule
        \multirow{2}{*}{cooler \& repumper} & A & s - t & \SI{50}{\percent} \\
        & B & s - u & \SI{51}{\percent} \\
        \midrule
        \multirow{2}{*}{cooler} & A & q - t & \SI{49}{\percent} \\
        & B & q - u & \SI{53}{\percent} \\
        \midrule
        \multirow{2}{*}{repumper} & A & p - t & \SI{51}{\percent} \\
        & B & p - u & \SI{49}{\percent} \\
        \bottomrule
    \end{tabular}
    \caption{Measured power splitting ratios into branches A and B on the polarizing beam splitter cube s on the optics board for the two-dimensional magneto-optical trap}
    \label{tab:power_splitting}
\end{table}



\chapter{The Jones and Azimuth-Ellipticity Polarization Bases}\label{ch:pypol_trafos}
Polarization is commonly represented in the Jones basis, the Mueller basis, or in the azimuth-ellipticity basis of a Poincaré sphere. For reference, transformations between the Jones and the azimuth-ellipticity basis are outlined here, as they were used for polarization characterizations in chapter~\ref{ch:projected_implementation}. This appendix chapter follows~\cite{trager_springer_2012}, but with a different definition of right- and left-handedness.

\section*{Transformations}
In the Jones basis, polarization is denoted using two basis vectors, say $\{\KetText{H}, \KetText{V}\}$ (horizontal and vertical). Up to a global phase, each polarization vector $\vec J$ can be represented using the three real valued parameters $h > 0$, $v > 0$, $\phi$:\footnote[1]{The sign of $\phi$ was chosen such that right-handed circular polarization is represented as $\frac{1}{\sqrt{2}}\begin{pmatrix}1 \\ -i \end{pmatrix}$ in the Jones basis, as $V > 0$ in the Mueller basis, and as $\epsilon  = \SI{45}{\degree}$ in the azimuth-ellipticity basis.}
\begin{align}
    \vec J = \begin{pmatrix}h \\ v \exp(-i \phi)\end{pmatrix}
\end{align}

The azimuth-ellipticity basis of the Poincaré sphere identifies polarizations by the azimuth $\alpha \in \left[-\frac{\pi}{2}, +\frac{\pi}{2}\right]$ and the ellipticity $\epsilon \in \left[-\frac{\pi}{4}, +\frac{\pi}{4}\right]$. In two dimensions, a polarization state can be visualized as an ellipse in an $h$-$v$ plane, collapsing into a line for linear and extending into a circle for circular polarization, as displayed in figure~\ref{fig:azimuth_ellipticity_visualization}.

\begin{figure}
    \centering
    \scalebox{0.8}{
    \begin{pgfpicture}
        \pgftext{\input{\imagepath/azimuth_ellipticity_visualization/azimuth_ellipticity_visualization.pgf}}
    \end{pgfpicture}
    }
    \caption{Two-dimensional visualization of polarization states as ellipses in the azimuth-ellipticity basis: The azimuth $\alpha$ denotes the inclination of the ellipse, whereas the ellipticity $\epsilon$ indicates the ratio of the short and the long axes of the ellipse. For the elliptical example with $\alpha = \frac{\pi}{6}$ and $\epsilon = \frac{\pi}{12}$, the angles were added to the drawing.}
    \label{fig:azimuth_ellipticity_visualization}
\end{figure}

In the following the Mueller-Stokes basis is going to be used as an intermediary for transforming between the Jones and the azimuth-ellipticity bases.

\paragraph*{Jones to Azimuth-Ellipticity}
In the Mueller basis, a given Jones polarization vector with $h$, $v$, and $\phi$ is represented as a stokes vector:
\begin{align}
    \vec S = \begin{pmatrix}
        I \\ Q \\ U \\ V
    \end{pmatrix} = 
    \begin{pmatrix}
      h^2 + v^2\\
      h^2 - v^2\\
      2hv \cos \phi\\
      2hv \sin \phi  
    \end{pmatrix}
\end{align}

In the azimuth-ellipticity basis of the Poincaré sphere, this state is expressed as
\begin{align}
    \begin{pmatrix}\alpha \\ \epsilon \end{pmatrix} =
    \begin{pmatrix}
        \frac{1}{2} \arctan \frac{2hv \cos \phi}{h^2 - v^2} + \Omega_{h, v}\\
        \frac{1}{2} \arcsin \frac{2hv\sin\phi}{h^2 + v^2}
    \end{pmatrix}
    ,
\end{align}
with $\Omega_{h > v} = 0$ and $\Omega_{h \leq v} = \frac{\pi}{2}$ ensuring that $\alpha$ matches. Table~\ref{tab:jones_to_ae_special_cases} lists the special cases of these expressions.
\begin{table}
    \centering
    \begin{tabular}{ccccc}
        \toprule
        \multicolumn{2}{c}{Jones basis} && $\alpha$ & $\epsilon$ \\
        \toprule
        $\KetText{H}$ & $h = 1, v = 0$ && \SI[]{0}{\degree} & \SI[]{0}{\degree} \\
        $\KetText{V}$ & $h = 0, v = 1$ && \SI[]{+90}{\degree} & \SI[]{0}{\degree} \\
        $\KetText{D}$ & $h = \sqrt{\frac{1}{2}}, v = \sqrt{\frac{1}{2}}, \phi = 0$ && \SI[]{+45}{\degree} & \SI[]{0}{\degree} \\
        $\KetText{A}$ & $h = \sqrt{\frac{1}{2}}, v = \sqrt{\frac{1}{2}}, \phi = \pm\pi$ && \SI[]{-45}{\degree} & \SI[]{0}{\degree} \\
        $\KetText{R}$ & $h = \sqrt{\frac{1}{2}}, v = \sqrt{\frac{1}{2}}, \phi = \frac{\pi}{2}$ && any & \SI[]{+45}{\degree} \\
        $\KetText{L}$ & $h = \sqrt{\frac{1}{2}}, v = \sqrt{\frac{1}{2}}, \phi = -\frac{\pi}{2}$ && any & \SI[]{-45}{\degree} \\
        \bottomrule
    \end{tabular}
    \caption{Special cases in the transformation from the Jones to the azimuth-ellipticity basis (with $h^2 + v^2 = 1$)}   
    \label{tab:jones_to_ae_special_cases}
\end{table}

\paragraph*{Azimuth-Ellipticity to Jones}
For a given azimuth $\alpha$ and ellipticity $\epsilon$, the Stokes vector can be determined up to its first component $I$:
\begin{align}
    \vec S = I \cdot 
    \begin{pmatrix}
        1 \\
        \cos (2\alpha) \cos(2\epsilon) \\
        \sin (2\alpha) \cos(2\epsilon) \\
        \sin(2\epsilon) \\
    \end{pmatrix}.
\end{align}

For $I = 1$, one can conclude the Jones vector parameters $h$, $v$, and $\phi$ from this vector.

$V / U$ gives $\tan \phi = \frac{\tan(2\epsilon)}{\sin(2\alpha)}$, so
\begin{align}
    \phi = \arctan \frac{\tan(2\epsilon)}{\sin(2\alpha)},
\end{align}
with special cases listed in table~\ref{tab:jones_to_ae_special_cases}.

$I + Q$ yields $ 2 h^2 = 1 + \cos(2\alpha) \cos(2\epsilon)$, so:
\begin{align}
    h = \sqrt{\frac{1 + \cos(2\alpha) \cos(2\epsilon)}{2}}
\end{align}

Analogously, $I - Q$ yields $ 2 v^2 = 1 - \cos(2\alpha) \cos(2\epsilon)$, so:
\begin{align}
    v = \sqrt{\frac{1 - \cos(2\alpha) \cos(2\epsilon)}{2}}
\end{align}


\section*{Using py-pol for Transforming from the Azimuth-Ellipticity Basis}
Using the Python library py-pol~\cite{noauthor_python_nodate} polarization vectors can be transformed from the azimuth-ellipticity basis to the Jones basis with
\begin{lstlisting}[language=Python]
def azimuth_ellipticity_to_jones(alpha, epsilon):
    polarisation = pypol.jones_vector.Jones_vector()
    polarisation.general_azimuth_ellipticity(alpha, epsilon)
    polarisation = polarisation.remove_global_phase()
    h, v = polarisation.parameters.components()
    v = v.conjugate()
    return h, v
\end{lstlisting}

Note that py-pol, as also in~\cite{trager_springer_2012}, defines $\KetText{R} = \frac{1}{\sqrt{2}}(\KetText{H}+i\KetText{V})$ and $\KetText{L} = \frac{1}{\sqrt{2}}(\KetText{H}-i\KetText{V})$, which is why the $v$ component is conjugated.




\chapter{Coil Simulation Library}\label{ch:coil_simulation_library}
\section*{Outline of the implementation}
The coil simulation library features three base classes:
\begin{itemize}
    \item \texttt{CoilArrangement}, \textit{abstract}: This class models an arrangement of sets of coils with a common axis, symmetrical on the $xz$ plane. In order to model a coil arrangement, this class needs to be subclassed, with the subclass implementing the method \texttt{\_compile\_single\_stack}. A \texttt{CoilArrangement} is parameterized by
    \begin{itemize}
        \item the \texttt{name} of the arrangement,
        \item the \texttt{radius} of a coil (only for reference for the subclasses),
        \item the \texttt{current}, which is either a constant value or a function \texttt{current(coil\_index, row, column)} assigning different currents to each coil and windings by their on- (\texttt{row}) and cross-axis (\texttt{column}) index,
        \item the dimension \texttt{wire\_spacing} of the wire,
        \item the \texttt{on\_axis\_coil\_distance}, and
        \item whether the arrangement is operated in \texttt{gradient} mode.
    \end{itemize}
    \item \texttt{FieldMap}: This class provides maps of the field generated by a \texttt{CoilArrangement} and can plot the field along slices through the field maps and 3D plots of them.
    \item \texttt{CurvatureAnalyzer}: This class calculates trap frequencies and gradients of the field of an arrangement or pre-calculated fields.
\end{itemize}

The following coil geometries were implemented by subclassing \texttt{CoilArrangement}:
\begin{itemize}
    \item \texttt{ConeShapedCoilArrangement}: An cone shaped arrangement with increasing radius of the winding layers along the coil axis. Parameterized by \texttt{windings\_axis} along the arrangement axis ($y$), \texttt{windings\_cross\_axis}, and the opening angle \texttt{cone\_angle} of the cone (relating the on-axis position of a winding layer and its radius).
    \item \texttt{StackShapedCoilArrangement}: A \texttt{ConeShapedCoilArrangement} with \texttt{cone\_angle} = \SI[]{0}{\degree}.
    \item \texttt{LithiumLayoutShapedCoilArrangement}: A coil arrangement as suggested in~\cite{gantner_magnetic_2012}.
    \item \texttt{FourPancakeArrangement}: A coil arrangement of two equally sized stack shaped coils with a center-of-mass distance \texttt{coil\_width} for each other on each side of the arrangement (written by the student research assistant Jan Wozniak).
    \item \texttt{FourPancakeArrangementWithJumpingCoils}: Arrangement of four coils with additional jumping coils (written by the student research assistant Jan Wozniak).
\end{itemize}


\section*{Usage Examples}
The usage of the \textit{coil simulation library} is exemplarily shown with the following examples of a \texttt{ConeShapedArrangement}.

\subsection*{Instantiation}
\begin{lstlisting}[language=Python]
import coil_simulation_lib as csl
COIL_PROPERTIES = {
 'windings_axis': 6,
 'windings_cross_axis': 5,
 'cone_angle': np.arctan(1),
 'current': 400,  # A
 'gradient': True,
 'radius': 83e-3,  # m
 'wire_spacing': 5.3e-3,  # m
 'on_axis_coil_distance': 85.5e-3,  # m
 'non_conducting_cross_section_area': (1.5e-3)**2*np.pi + 4*(5e-3*0.15e-3)  # m^2
}
arrangement = csl.ConeShapedCoilArrangement(**COIL_PROPERTIES)
\end{lstlisting}

\subsection*{Visualization}
\begin{lstlisting}[language=Python]
arrangement.plot_arrangement_schematic(figsize=(9, 7), filename='schematic.pgf')
arrangement.display_in_3D(figsize=(9, 9), filename='3d.pgf')
\end{lstlisting}

\subsection*{Field Mapping}
\begin{lstlisting}[language=Python]
field_map_xy = csl.FieldMap(arrangement, 'xy', steps=100)
field_map_xy.plot_map()  # color map
field_map_xy.plot_landscape()  # 3D visualization
field_map_xy.plot_slices()  # field along axes
\end{lstlisting}

\subsection*{Field Strength, Gradient, and Curvature}
\begin{lstlisting}[language=Python]
arrangement.field_at_center() * 1e4  # field at the center in G
curvature_analyzer = csl.CurvatureAnalyzer().from_arrangement(arrangement)
curvature_analyzer.get_trap_frequency_on_axis("x")  # trap frequency along x in Hz
curvature_analyzer.get_gradient_on_axis("x")*1e2  # gradient along x in G/cm
\end{lstlisting}

\subsection*{Coil Properties}
\begin{lstlisting}[language=Python]
arrangement.get_total_coil_length()/2  # length of a single coil in m
arrangement.get_single_coil_resistance()*1000  # resistance in mOhm
arrangement.estimate_single_coil_self_inductance()*1000  # inductance in mH
arrangement.get_single_coil_L_over_R_time()*1000  # single coil L/R time in ms
arrangement.estimate_all_coils_self_inductance()*1000  # all-coil inductance in mH
arrangement.get_all_coils_L_over_R_time()*1000  # all coils L/R time in ms
arrangement.get_magnetic_dipole_moment(coil_index=0)  # coil mag. moment in A m^2
arrangement.get_magnetic_dipole_moment()  # arrangement mag. dipole moment in A m^2
arrangement.get_total_outward_force_on_single_coil()  # outward force in N
\end{lstlisting}

\section*{Implementing New Coil Geometries}
In order to implement new coil geometries, a subclass of \texttt{CoilArrangement} implementing the \texttt{\_compile\_single\_stack} method must be written.

\texttt{\_compile\_single\_stack} layouts the geometry of the coil by configuring each winding of the coil as a \textit{magpylib}~\cite{noauthor_magpylibmagpylib_nodate} current loop and placing it in its position. It takes the \texttt{coil\_index} $\in \{-1, 1\}$ as an argument, indicating whether the left or the right coil should be laid out.

Conceptually, the implementation should iterate over all on-axis and cross-axis windings, adding a \textit{magpylib} current loop to a collection for each winding, and return the collection. The geometry is implemented by setting the position and radius of each winding as desired.
\begin{lstlisting}
collection = mpl.Collection()
current_factor = 1 if coil_index == 0 else -1  # opposite polarity on both sides
for row in range(self.windings_axis):
    on_axis_offset = (row - self.windings_axis/2 + 0.5) * winding_spacing
    for column in range(self.windings_cross_axis):
        radial_offset = (
            np.tan(self.cone_angle)*on_axis_offset
            + (column-self.windings_cross_axis/2+0.5) * winding_spacing
        )
        current = self.get_current(coil_index=coil_index, row=row, column=column)*current_factor
        loop = mpl.current.Loop(
            current=current,
            diameter=2*radius+2*radial_offset,
            position=(0, 0, on_axis_offset)
        )
        collection.add(loop)
return collection
\end{lstlisting}
The \texttt{current\_factor} ensures that the fields actually have same polarity in homogeneous field mode. The \texttt{self.gradient} property doesn't need to be considered here. The call to \texttt{self.get\_current} retrieves the current, which can be set independently each coil and each winding.



\chapter{Rules of Thumb for Magnetic Fields and Gradients}
The following rules of thumb are useful for calculating the magnitude of homogeneous fields and gradients for coils in Helmholtz configuration, meaning that the distance of the coils equals their radius.

\section*{Homogeneous Fields}
The field in \href{https://www.youtube.com/watch?v=_3_JVVs2Kls}{Gauss} at the center of a Helmholtz configuration of coils of radius $r$, distance $r$, operated at current $I$ can be estimated as
\begin{align}\label{eq:rot_field}
    B(r, I) \approx \left. \frac{I}{\SI{1}{\ampere}} \middle/ \frac{r}{\SI{1}{\centi\meter}} ~ \cdot ~\SI{1}{\gauss}\right. .
\end{align}
This means that, roughly speaking, coils in  Helmholtz configuration generate a field of
\begin{align}\nonumber
    \SI{1}{\gauss} ~~ \text{per} ~~ \frac{\si{\ampere} ~~ \text{of current}}{\si{\centi\meter} ~~ \text{of radius}}~.
\end{align}

Figure~\ref{fig:rot_field} compares this rule of thumb to exact simulations with the \textit{coil simulation library} (see~\ref{ch:simulation} and~\ref{ch:coil_simulation_library}). The rule of thumb overestimates the field by about \SI{10}{\percent}.

\begin{figure}
    \centering
    \begin{subfigure}[t]{0.48\textwidth}
        \centering
        \begin{pgfpicture}
            \pgftext{\input{\imagepath/rule_of_thumb_field/rule_of_thumb_field_radius.pgf}}
        \end{pgfpicture}
        \caption{Dependency on the radius, with the coil distance fixed to the radius}
        \label{fig:rot_field_radius}
    \end{subfigure} 
    \hspace{0.03\textwidth}
    \begin{subfigure}[t]{0.48\textwidth}
        \centering
        \begin{pgfpicture}
            \pgftext{\input{\imagepath/rule_of_thumb_field/rule_of_thumb_field_current.pgf}}
        \end{pgfpicture}
        \caption{Dependency on the current}
        \label{fig:rot_field_current}
    \end{subfigure} 

    \begin{subfigure}{\textwidth}
        \centering
        \begin{pgfpicture}
            \pgftext{\input{\imagepath/rule_of_thumb_field/rule_of_thumb_field_3d.pgf}}
        \end{pgfpicture}
        \caption{Field as a function of radius and current: Exact fields are displayed in red, the rule-of-thumb approximation in gray above.}
        \label{fig:rot_field_3d}
    \end{subfigure}
    \caption{Fields in the center of a Helmholtz arrangement of coils for different radii and currents, comparing the rule of thumb \eqref{eq:rot_field} with simulated values. Parameters: $I = \SI{100}{\ampere}, r = \SI{10}{\centi\meter}, N_\text{windings} = 1$}
    \label{fig:rot_field}
\end{figure}


\section*{Gradient Fields}
A similar rule of thumb can be formulated for the gradient around the center between coils in the same configuration, meaning the distance of the coils equals their radius, along the coil axis:
\begin{align}\label{eq:rot_gradient}
    \pdv{B(r, I)}{x_\text{on-axis}} \approx \left. \frac{I}{\SI{1}{\ampere}} \middle/ \left(\frac{r}{\SI{1}{\centi\meter}}\right)^2 ~\cdot~ \SI{1}{\gauss\per\centi\meter} \right.
\end{align}

Figure~\ref{fig:rot_gradient} compares the rule of thumb to simulations with the \textit{coil simulation library} (see~\ref{ch:simulation} and~\ref{ch:coil_simulation_library}). The rule of thumb underestimates the gradient by about \SI{10}{\percent}.

\begin{figure}
    \centering
    \begin{subfigure}[t]{0.48\textwidth}
        \centering
        \begin{pgfpicture}
            \pgftext{\input{\imagepath/rule_of_thumb_gradient/rule_of_thumb_gradient_radius.pgf}}
        \end{pgfpicture}
        \caption{Dependency on the radius, with the coil distance fixed to the radius}
        \label{fig:rot_gradient_radius}
    \end{subfigure}
    \hspace{0.03\textwidth}
    \begin{subfigure}[t]{0.48\textwidth}
        \centering
        \begin{pgfpicture}
            \pgftext{\input{\imagepath/rule_of_thumb_gradient/rule_of_thumb_gradient_current.pgf}}
        \end{pgfpicture}
        \caption{Dependency on the current}
        \label{fig:rot_gradient_current}
    \end{subfigure}

    \begin{subfigure}{\textwidth}
        \centering
        \begin{pgfpicture}
            \pgftext{\input{\imagepath/rule_of_thumb_gradient/rule_of_thumb_gradient_3d.pgf}}
        \end{pgfpicture}
        \caption{Gradient as a function of radius and current: Simulated gradients are displayed in red, the rule-of-thumb approximation in gray below.}
        \label{fig:rot_gradient_3d}
    \end{subfigure}
    \caption{Gradients around the center of a Helmholtz arrangement of coils with mutually invert currents for different radii and currents, comparing the rule of thumb \eqref{eq:rot_gradient} with simulated values. Parameters: $I = \SI{100}{\ampere}, r = \SI{10}{\centi\meter}, N_\text{windings} = 1$}
    \label{fig:rot_gradient}
\end{figure}
