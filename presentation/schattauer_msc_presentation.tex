\newcommand{\textpath}{../text}
\newcommand{\imagepath}{}

\input{presentation_headers.tex}

\begin{document}
% TITLE
\begin{frame}
	\begin{center}
		\begin{block}
			{\centering \\
				\medskip
				\textbf{\textsc{3D MOT and Feshbach Coils}}\\
				\medskip}
		\end{block}

		\bigskip

		Master's thesis discussion\\
		\medskip
		November 18, 2022\\

		\vspace{1cm}
		\textbf{Maximilian Schattauer}
	\end{center}
\end{frame}

\renewcommand{\imagepath}{\textpath/30-mot/img}

\begin{frame}
	\begin{figure}
        \raggedleft
        \includegraphics[scale=0.6]{\imagepath/restoring_on_opposite_sides_schematic/restoring_on_opposite_sides_schematic.pdf}
    \end{figure}
    \section{3D MOT}
\end{frame}

\begin{frame}
    \frametitle{Optical Molasses}
    \begin{columns}
        \onslide<+->
        \begin{column}[]{0.48\textwidth}
            \begin{figure}
                \includegraphics[scale=0.7]{\imagepath/light_scattering_momentum_transfer/light_scattering_momentum_transfer.pdf}
            \end{figure}
        \end{column}
        
        \onslide<+->
        \begin{column}[]{0.48\textwidth}
            \begin{figure}
                \scalebox{0.7}{
                    \begin{pgfpicture}
                        \pgftext{\input{\imagepath/optical_molasses_force/optical_molasses_force.pgf}}
                    \end{pgfpicture}
                }
            \end{figure}
        \end{column}
\end{columns}

\onslide<+->
\begin{align*}
    F_\mathrm{OM} = F_\mathrm{scatter}(\omega_\mathrm{laser} - \omega_\mathrm{transition} - kv \cos \theta) - F_\mathrm{scatter}(\omega_\mathrm{laser} - \omega_\mathrm{transition} + kv \cos \theta)
\end{align*}

\end{frame}

\begin{frame}
    \frametitle{Optical Molasses}
    \begin{align*}
        F_\mathrm{OM} = F_\mathrm{scatter}(\omega_\mathrm{laser} - \omega_\mathrm{transition} - kv \cos \theta) - F_\mathrm{scatter}(\omega_\mathrm{laser} - \omega_\mathrm{transition} + kv \cos \theta)
    \end{align*}
    
    For slow velocities $v \ll \frac{\Gamma}{k}$:
    \begin{equation*}
            F_\mathrm{OM} \approx - 2 \pdv{F_\mathrm{scatter}}{\omega} k v \cos \theta \equiv -( \alpha \cos \theta) v
    \end{equation*}
\end{frame}

\begin{frame}
    \frametitle{Back to the MOT}
    How to get spatial confinement?
    \begin{itemize}
        \item position-dependent detuning of $m \rightarrow m \pm 1$ transition via Zeeman shift:
        \begin{align*}
            \omega_\text{transition}(q) = \omega_\text{transition} \pm \frac{\Delta E(q)}{\hbar} = \omega_\text{transition} \pm \frac{g \mu_\text{B}}{\hbar} \pdv{B}{q} q \equiv \omega_\text{transition} \pm \beta q
        \end{align*}
        \pause
        \item use of $\sigma^+$- and $\sigma^-$-polarized beams
    \end{itemize}
\end{frame}


\begin{frame}
    \frametitle{Back to the MOT}
    \begin{figure}
        \centering
        \includegraphics[scale=0.75]{\imagepath/detuning_and_selection_rules_schematic/detuning_and_selection_rules_schematic.pdf}
    \end{figure}

    \pause
    \begin{align*}
        \onslide<+->{
        F_\text{MOT} &= F_\text{scatter}^{\sigma^+}(\omega_\text{laser} - \omega_\text{transition}(q) - kv \cos \theta) - F_\text{scatter}^{\sigma^-}(\omega_\text{laser} - \omega_\text{transition}(q) + kv \cos \theta)} \\ \nonumber
        \onslide<+->{&\approx -2 \pdv{F_\text{scatter}}{\omega} k\cos \theta v + 2 \pdv{F_\text{scatter}}{\omega_0} \beta q  \equiv - (\alpha \cos \theta) v - \frac{\alpha \beta}{k} q}
    \end{align*}
\end{frame}

\begin{frame}
	\frametitle{Back to the MOT}
	\begin{figure}
        \centering
        \includegraphics[height=0.8\textheight]{\imagepath/restoring_on_opposite_sides_schematic/restoring_on_opposite_sides_schematic.pdf}
    \end{figure}

    {\tiny Different helicities, same polarization! ($\sigma^+ \neq \Ket{\text{R}}$, $\sigma^- \neq \Ket{\text{L}}$)}
\end{frame}

\begin{frame}
    \frametitle{Transitions in a Lithium MOT}
    \begin{figure}
        \centering
        \includegraphics[scale=0.7]{\imagepath/cooler_repumper_in_alkali/cooler_repumper_in_alkali.pdf}
    \end{figure}
\end{frame}

\begin{frame}
    \frametitle{Capture velocity}
    Kinetic energy $\frac{1}{2}mv^2$ dissipated by force $\frac{\Gamma}{2} \hbar k$ along trajectory $2 r_\text{trap}$ in the MOT:
    \begin{align*}\label{eq:capture_velocity_high}
        v_\text{capture, max}^\text{high} = \sqrt{\frac{\hbar k \Gamma \cdot 2 r_\text{trap}}{m}} = \SI[]{90}{\meter\per\second}
    \end{align*}
\end{frame}

\begin{frame}
    \frametitle{Polarization}
    \begin{figure}
        \includegraphics[scale=0.7]{\imagepath/glass_cell_sides_mot_beams/glass_cell_sides_mot_beams_1.pdf}
    \end{figure}
\end{frame}

\begin{frame}
    \frametitle{Polarization}
    \begin{columns}
        \begin{column}[]{0.45\textwidth}
            \centering
            First pass:
            \begin{figure}
                \includegraphics[scale=0.5]{\imagepath/first_pass_polarization_measurement_scheme/first_pass_polarization_measurement_scheme.pdf}
            \end{figure}
        \end{column}
        \begin{column}[]{0.55\textwidth}
            \centering
            Second pass:
            \begin{figure}
                \includegraphics[scale=0.5]{\imagepath/second_pass_waveplate_adjustment_scheme/second_pass_waveplate_adjustment_scheme.pdf}
            \end{figure}
        \end{column}
    \end{columns}
\end{frame}

\renewcommand{\imagepath}{\textpath/40-coils/img}

\begin{frame}
    \begin{figure}
        \raggedleft
        \includegraphics[]{\imagepath/single_coil_drawing/single_coil_drawing.pdf}
    \end{figure}
    \section{Feshbach Coils}
\end{frame}

\begin{frame}
    \frametitle{Constraints}

    \begin{columns}
        \begin{column}{0.4\textwidth}
            \begin{itemize}
                \item tight geometry
                \item field strength $\gg \SI[]{832}{\gauss}$
                \item water cooling
                \item curvature
            \end{itemize}
        \end{column}

        \begin{column}{0.55\textwidth}
            \begin{figure}
                \includegraphics[scale=0.7]{\imagepath/feshbach_coil_geometry_constraints/feshbach_coil_geometry_constraints.pdf}
            \end{figure}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}
    \frametitle{Tight Geometry}
    \begin{figure}
        \includegraphics[scale=0.8]{\imagepath/parallelogram_cross_section/parallelogram_cross_section.pdf}
    \end{figure}
\end{frame}

\begin{frame}
    \frametitle{Field Strength}
    \begin{tikzpicture}
        \node (map) {\includegraphics[scale=0.7]{\imagepath/feshbach_field_map/feshbach_field_map.pdf}};
        \pause
        \node (overlay) at (map.south west) {\begin{pgfpicture}
            \pgftext{\input{\imagepath/feshbach_field_slices/feshbach_field_slices_xy.pgf}}
        \end{pgfpicture}};
    \end{tikzpicture}
\end{frame}

\renewcommand{\imagepath}{\textpath/90-appendix/img}
\setbeamercovered{transparent}
\begin{frame}
    \frametitle{Field Strength :: Rules of Thumb}
    \vspace{0.5cm}

    \begin{columns}
        \begin{column}{0.38\textwidth}
            \centering
            \onslide<1>{
                \textbf{Homogeneous field:}
                \begin{align*}
                    B(r, I) \approx \left. \frac{I}{\SI{1}{\ampere}} \middle/ \frac{r}{\SI{1}{\centi\meter}} ~ \cdot ~\SI{1}{\gauss}\right.
                \end{align*}

                ``$
                    \SI{1}{\gauss} ~~ \text{per} ~~ \frac{\si{\ampere} ~~ \text{of current}}{\si{\centi\meter} ~~ \text{of radius}}
                $''
            }

            \vspace{1cm}

            \onslide<2>{
                \centering
                \textbf{Gradient field:}
                    \begin{align*}
                        \pdv{B(r, I)}{x_\text{on-axis}} \approx \left. \frac{I}{\SI{1}{\ampere}} \middle/ \left(\frac{r}{\SI{1}{\centi\meter}}\right)^2 ~\cdot~ \SI{1}{\gauss\per\centi\meter} \right.
                    \end{align*}
            }
        \end{column}

        \begin{column}{0.6\textwidth}
            \only<1>{
                \begin{figure}
                    \centering
                    \scalebox{0.55}{
                        \begin{pgfpicture}
                            \pgftext{\input{\imagepath/rule_of_thumb_field/rule_of_thumb_field_radius.pgf}}
                        \end{pgfpicture}
                    }
                    \scalebox{0.55}{
                        \begin{pgfpicture}
                            \pgftext{\input{\imagepath/rule_of_thumb_field/rule_of_thumb_field_current.pgf}}
                        \end{pgfpicture}
                    }
                \end{figure}

                \begin{figure}
                    \centering
                    \scalebox{0.55}{
                        \begin{pgfpicture}
                            \pgftext{\input{\imagepath/rule_of_thumb_field/rule_of_thumb_field_3d.pgf}}
                        \end{pgfpicture}
                    }
                \end{figure}
            }

            \only<2>{
                \begin{figure}
                    \centering
                    \scalebox{0.55}{
                        \begin{pgfpicture}
                            \pgftext{\input{\imagepath/rule_of_thumb_gradient/rule_of_thumb_gradient_radius.pgf}}
                        \end{pgfpicture}
                    }
                    \scalebox{0.55}{
                        \begin{pgfpicture}
                            \pgftext{\input{\imagepath/rule_of_thumb_gradient/rule_of_thumb_gradient_current.pgf}}
                        \end{pgfpicture}
                    }
                \end{figure}

                \begin{figure}
                    \centering
                    \scalebox{0.55}{
                        \begin{pgfpicture}
                            \pgftext{\input{\imagepath/rule_of_thumb_gradient/rule_of_thumb_gradient_3d.pgf}}
                        \end{pgfpicture}
                    }
                \end{figure}
            }
        \end{column}
    \end{columns}
\end{frame}
\setbeamercovered{}

\renewcommand{\imagepath}{\textpath/40-coils/img}
\begin{frame}
    \frametitle{Curvature}
    \begin{figure}
        \begin{pgfpicture}
            \pgftext{\input{\imagepath/field_landscape/field_landscape.pgf}}
        \end{pgfpicture}
    \end{figure}
\end{frame}

\begin{frame}
    \frametitle{Curvature}
    \begin{align*}
        \underbrace{V_0 + \frac{1}{2}m\omega^2q^2}_{V_\text{HO}(q)} ~~~=~~~ \underbrace{\mp \mu_\text{B} B_0 \mp \mu a_{\vec q} q^2}_{V_\text{magnetic}(q)}
    \end{align*}
    \onslide<+->
    \begin{align*}
        \omega_{\vec q} = \sqrt[]{\mp\frac{2 \mu_\text{B} a_{\vec q}}{m}}
    \end{align*}

    {\tiny $-$ for high-field seekers, $+$ for low-field seekers}
\end{frame}

\begin{frame}
    \frametitle{Curvature}
    \begin{figure}
        \centering
        \begin{pgfpicture}
            \pgftext{\input{\imagepath/feshbach_field_trap_frequencies/feshbach_field_trap_frequencies.pgf}}
        \end{pgfpicture}
    \end{figure}
\end{frame}

\begin{frame}
    \frametitle{Characterization}
    \begin{figure}
        \centering
        \scalebox{0.7}{
            \begin{pgfpicture}
                \pgftext{\input{\imagepath/single_coil_fields/single_coil_fields.pgf}}
            \end{pgfpicture}
        }
    \end{figure}
    {\tiny 
        Field fit function: $\hat B[I, r, y_0](y) = \sum\limits_{a = 0}^5 \sum\limits_{c = 0}^4 \frac{\mu_0 I}{2} \frac{r_{ac}^2}{\left(r_{ac}^2 + (y - y_{ac})^2\right)^\frac{3}{2}}$.
    }
\end{frame}

\begin{frame}
    \frametitle{Optimization}
    \begin{figure}
        \centering
        \begin{subfigure}[t]{0.4\textwidth}
            \centering
            \includegraphics[]{\imagepath/position_optimization/position_optimization_gradient.pdf}
        \end{subfigure}
        \hspace{0.05\textwidth}
        \begin{subfigure}[t]{0.4\textwidth}
            \centering
            \includegraphics[]{\imagepath/position_optimization/position_optimization_trapfrequency.pdf}
        \end{subfigure}
    \end{figure}
\end{frame}


\begin{frame}
    \section{Coil simulation library}
\end{frame}

\begin{frame}
    \frametitle{Basic concepts}
    \begin{itemize}
        \item simulating coil arrangements
        \item flexible winding geometry
        \item field, gradient, and curvature estimation
        \item coil property estimations
    \end{itemize}
\end{frame}

\begin{frame}[fragile]
    \frametitle{Usage}
    Instantiation:
    \begin{lstlisting}
import coil_simulation_lib as csl
COIL_PROPERTIES = {
    'windings_axis': 6,
    'windings_cross_axis': 5,
    'cone_angle': np.arctan(1),
    'current': 400,  # A
    'gradient': True,
    'radius': 83e-3,  # m
    'wire_spacing': 5.3e-3,  # m
    'on_axis_coil_distance': 85.5e-3,  # m
    'non_conducting_cross_section_area': (1.5e-3)**2*np.pi + 4 * (5e-3 * 0.15e-3)  # m^2
}
arrangement = csl.ConeShapedCoilArrangement(**COIL_PROPERTIES)
    \end{lstlisting}
\end{frame}

\begin{frame}[fragile]
    \frametitle{Usage}
    \begin{columns}
        \begin{column}{0.8\textwidth}
            Visualization:
            \begin{lstlisting}[language=Python]
arrangement.plot_arrangement_schematic(figsize=(9, 7), filename='schematic.pgf')
arrangement.display_in_3D(figsize=(9, 9), filename='3d.pgf')
            \end{lstlisting}
        \end{column}
        \begin{column}{0.19\textwidth}
            \begin{figure}
                \centering
                \scalebox{0.3}{
                    \begin{pgfpicture}
                        \pgftext{\input{\imagepath/csl_sketches/csl_sketches_3d.pgf}}
                    \end{pgfpicture}
                }
            \end{figure}
        \end{column}
    \end{columns}

    \pause
    \vspace{0.5cm}
    \begin{columns}
        \begin{column}{0.6\textwidth}
            Field Mapping:
            \begin{lstlisting}[language=Python]
field_map_xy = csl.FieldMap(arrangement, 'xy', steps=100)
field_map_xy.plot_map()  # color map
field_map_xy.plot_landscape()  # 3D visualization
field_map_xy.plot_slices()  # field along axes
            \end{lstlisting}
        \end{column}
        \begin{column}{0.39\textwidth}
            \begin{tikzpicture}
                \node (map) {\includegraphics[scale=0.25]{\imagepath/gradient_field_map/gradient_field_map.pdf}};
                \node[scale=0.5] (slices) at (map.south east) {\pgftext{\input{\imagepath/gradient_field_slices/gradient_field_slices_xy.pgf}}};
                % \node (3d) at (slices.south east) {\begin{pgfpicture}\pgftext{\input{\imagepath/field_landscape/field_landscape.pgf}}\end{pgfpicture}};
            \end{tikzpicture}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}[fragile]
    \frametitle{Implementing a new coil geometry}

    \begin{columns}
        \begin{column}{0.5\textwidth}
            {\tiny
                Steps:
                \begin{itemize}
                    \item Subclass \texttt{CoilArrangement}
                    \item Implement method \texttt{\_compile\_single\_stack}
                    \item Define radius and position of every winding
                \end{itemize}
            }
        \end{column}
        \begin{column}{0.48\textwidth}
            \begin{figure}
                \centering
                \includegraphics[scale=0.5]{\imagepath/coil_model/coil_model.pdf}
            \end{figure}
        \end{column}
    \end{columns}
    
    \pause
    \vspace{0.5cm}
    \begin{lstlisting}
collection = mpl.Collection()
current_factor = 1 if coil_index == 0 else -1  # opposite polarity on both sides
for row in range(self.windings_axis):
        on_axis_offset = (row - self.windings_axis/2 + 0.5) * winding_spacing
        for column in range(self.windings_cross_axis):
            radial_offset = np.tan(self.cone_angle)*on_axis_offset + (column - self.windings_cross_axis/2 + 0.5) * winding_spacing
            current = self.get_current(coil_index=coil_index, row=row, column=column)*current_factor
            loop = mpl.current.Loop(current=current, diameter=2*radius+2*radial_offset, position=(0, 0, on_axis_offset)
            collection.add(loop)
return collection
        \end{lstlisting}
\end{frame}


\begin{frame}
    \section*{Thank you!}
\end{frame}

\end{document}